% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sequence_comparison.R
\name{compare_sequences}
\alias{compare_sequences}
\title{Compare Sequences Between Groups}
\usage{
compare_sequences(
  data,
  group,
  min_length = 2,
  max_length = 5,
  top_n = 10,
  detailed = FALSE,
  statistical = FALSE,
  correction = "bonferroni",
  test_method = "auto",
  min_expected = 5,
  min_frequency = 2,
  legend = TRUE,
  cell_values = FALSE,
  plot = TRUE
)
}
\arguments{
\item{data}{A data frame containing sequence data in wide format, where each row
represents a sequence and each column represents a time point}

\item{group}{Column name or index containing group information, or a vector indicating
group membership for each sequence. If data contains a group column, specify column
name (e.g., "Group") or pass as vector (e.g., data$Group)}

\item{min_length}{Minimum subsequence length to analyze (default: 2)}

\item{max_length}{Maximum subsequence length to analyze (default: 5)}

\item{top_n}{Number of top patterns to return and display (default: 10)}

\item{detailed}{Logical, whether to return detailed results by subsequence length
(default: FALSE). When TRUE, results are organized by length; when FALSE,
shows overall top patterns across all lengths}

\item{statistical}{Logical, whether to perform statistical testing (default: FALSE).
When TRUE, performs Chi-squared or Fisher's Exact tests; when FALSE, uses
discrimination score analysis. Only applies to 2-group analysis}

\item{correction}{Character, multiple comparison correction method (default: "bonferroni").
Supports all R p.adjust methods: "holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", "none"
Only applies to 2-group statistical analysis}

\item{test_method}{Character, statistical test selection (default: "auto").
Options: "auto", "fisher", "chi.squared". Only applies to 2-group statistical analysis}

\item{min_expected}{Numeric, minimum expected count for automatic test selection (default: 5).
Only applies to 2-group statistical analysis}

\item{min_frequency}{Numeric, minimum frequency for pattern inclusion in multi-group analysis (default: 2)}

\item{legend}{Logical, whether to show legend in visualizations (default: TRUE).
Currently for future visualization compatibility}

\item{cell_values}{Logical, whether to show cell values in visualizations (default: FALSE).
Currently for future visualization compatibility}

\item{plot}{Logical, whether to create plots automatically (default: TRUE).
When FALSE, no plots are generated during function execution}
}
\value{
For 2 groups: A compare_sequences object with statistical measures
For 3+ groups: A compare_sequences_multi object with discrimination measures
}
\description{
Performs comprehensive sequence comparison analysis between groups. Automatically
detects the number of groups and uses appropriate analysis methods:
\itemize{
\item For 2 groups: Full statistical analysis with tests, effect sizes, and detailed measures
\item For 3+ groups: Multi-group discrimination analysis with support-based measures
}
}
\examples{
\dontrun{
# Load example data
data(seqdata)

# Automatically detects 2 groups - uses detailed statistical analysis
result <- compare_sequences(seqdata, "Group")
print(result)

# Automatically detects 3+ groups - uses multi-group discrimination analysis
result <- compare_sequences(multigroup_data, "Group")
print(result)

# Statistical analysis (only for 2 groups)
result <- compare_sequences(seqdata, "Group", statistical = TRUE)

# Control visualization options
result <- compare_sequences(seqdata, "Group", legend = FALSE, cell_values = TRUE)

# Disable automatic plotting
result <- compare_sequences(seqdata, "Group", plot = FALSE)
}

}
